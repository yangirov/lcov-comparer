# lcov-comparer

[![npm version](https://badge.fury.io/js/lcov-comparer.svg)](https://www.npmjs.com/package/lcov-comparer)
[![license](https://img.shields.io/npm/l/lcov-comparer.svg)](./LICENSE)

A script to compare code coverage between two `lcov.info` reports and generate a visual HTML report with diffs for:

- Statements
- Branches
- Functions
- Lines

## ğŸš€ Usage

```sh
npx lcov-comparer coverage-old.info coverage-new.info

open coverage-diff.html
```

## ğŸ›  Options

| Flag              | Description                                                                   |
| ----------------- | ----------------------------------------------------------------------------- |
| `--out <file>`    | Output file path. Supported extensions: `.html`, `.json`, `.csv`.             |
| `--threshold <n>` | Only include files with at least `n%` change in any metric (Statements, etc). |

### Examples

```sh
# HTML output (default)
lcov-comparer old.info new.info --out diff.html

# CSV output with 10% threshold filter
lcov-comparer old.info new.info --out diff.csv --threshold 10

# JSON output
lcov-comparer old.info new.info --out diff.json
```

## ğŸ“¦ Formats Support

Compatible with lcov.info format generated by:

- vitest --coverage
- jest --coverage
- nyc

## ğŸ“ Output File

By default, script generates the file: `coverage-diff.html`

Open it in your browser to view a table showing per-file coverage differences between the two reports.

Example table:

| File       | Statements    | Î”      | Branches      | Î”      | Functions      | Î”      | Lines         | Î”      |
| ---------- | ------------- | ------ | ------------- | ------ | -------------- | ------ | ------------- | ------ |
| src/app.ts | 70.0% â†’ 90.0% | +20.0% | 40.0% â†’ 80.0% | +40.0% | 50.0% â†’ 100.0% | +50.0% | 70.0% â†’ 90.0% | +20.0% |

Files are automatically sorted by the most significant coverage change across all metrics.
